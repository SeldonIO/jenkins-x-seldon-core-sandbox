buildPack: none
pipelineConfig:
  pipelines:
    overrides:
    - name: changelog
      pipeline: release
      stage: promote
      step:
        command: echo "skipping promote"
    pullRequest:
      pipeline:
        agent:
          image: seldonio/core-builder:0.4
        stages:
        - name: build-and-test
          parallel:
          - name: test-python
            agent:
              image: seldonio/python-builder:0.2
            steps:
            - name: test-python
              command: make
              args:
              - -C python
              - update_package
              - install_dev
              - test
          - name: seldon-engine
            steps:
            - args:
              - -C engine
              - -f Makefile.ci
              - build_jar
              command: make
              name: test-engine
    release:
      setVersion:
        steps:
        - name: creating-version-file
          command: cat version.txt > VERSION
        - name: skip-tag
          command: echo "skipping tag"
      pipeline:
        agent:
          image: seldonio/core-builder:0.4
        stages:
          - name: build-and-push
            steps:
            - name: build-and-push-images
              command: echo "hello"
